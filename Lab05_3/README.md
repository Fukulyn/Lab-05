# Lab05_3
## 1. 函數相依性列表
### 學生 `Student`
- 學號 → 學生姓名, 主修系所名稱, 主修系所辦公室

### 課程 `Course`
- 課程代碼 → 課程名稱, 學分數, 開課系所代碼, 開課系所名稱

### 講師 `Instructor`
- 講師編號 → 講師姓名, 講師所屬系所代碼, 講師所屬系所名稱, 講師辦公室

### 選課記錄 `Enrollment`
- (學號, 課程代碼, 學期, 講師編號) → 成績

## 2.正規化步驟

### 1NF：移除集合型與嵌套欄位
- 每筆選課紀錄對應一筆資料（不可混合多門課程資訊在一列）

### 2NF：拆解成多個實體表
- 拆出學生表：學號 → 姓名、主修系所
- 拆出課程表：課程代碼 → 名稱、學分
- 拆出講師表：講師編號 → 姓名、辦公室、系所
- 設計中介表 `Enrollment(StudentID, CourseID, Semester, InstructorID, Grade)`

### 3NF：移除傳遞依賴
- 所有屬性都應直接依賴主鍵，而不是透過中介欄位
- 講師編號 → 所屬系所 → 系所名稱、地點
- 若重複出現，應再拆成 `Department` 表（系所資料）

## 如果要達成BCNF?
- `Enrollment` 表主鍵為 (`StudentID`, `CourseID`, `Semester`, `InstructorID`)
- 所有函數相依的左側為候選鍵 → 不需再進一步拆解

### 碰到的挑戰
#### 1. 複合主鍵過長（實作複雜）
-  若 `Enrollment` 表為符合 BCNF，主鍵需為 `(StudentID, CourseCode, Semester, InstructorID)`
-  成果是查詢與維護成本上升，例如查詢學生成績時必須知道講師 ID，語意混亂
#### 2. Instructor 並非 Grade 的唯一決定元素
- 成績通常由整體課程評量機制給出，而非某個特定講師決定
- 講師只是「授課記錄」，不應參與決定主鍵或決定成績
#### 3. 違反語意完整性
- 若某課程有多人授課，共享成績機制，強制納入 `InstructorID` 可能造成誤解  
-「成績是誰打的」與「誰教了這門課」在語意上不等價
#### 4. 對歷史資料與彈性查詢不友善
- 若講師異動或課程轉班，Enrollment 記錄會變得難追蹤或不一致
- 降低對歷史紀錄與跨學期查詢的整體彈性

### 保留3NF而不去進化到BCNF原因
- 資料語意清晰化
- 查詢效率與開發維護便利性
- 成績與講師資訊的邏輯分離

## 3. 正規化資料表設計

### Student
  | 欄位名稱       | 說明                   |
  |----------------|------------------------|
  | `StudentID`    | 主鍵，學生學號         |
  | `Name`         | 學生姓名               |
  | `MajorDeptCode`| 外鍵，主修科系代碼     |
### Course
  | 欄位名稱          | 說明                     |
  |-------------------|--------------------------|
  | `CourseCode`      | 主鍵，課程代碼           |
  | `CourseName`      | 課程名稱                 |
  | `Credits`         | 學分數                   |
  | `OfferingDeptCode`| 外鍵，開課系所代碼       |
### Instructor
  | 欄位名稱       | 說明                     |
  |----------------|--------------------------|
  | `InstructorID` | 主鍵，講師編號           |
  | `Name`         | 講師姓名                 |
  | `DeptCode`     | 外鍵，講師所屬系所代碼   |
  | `Office`       | 辦公室號碼               |
### Department
  | 欄位名稱    | 說明         |
  |-------------|--------------|
  | `DeptCode`  | 主鍵，系所代碼 |
  | `DeptName`  | 系所名稱     |
  | `Office`    | 系所辦公室位置 |
### Enrollment
  | 欄位名稱       | 說明                               |
  |----------------|-----------------------------------|
  | `StudentID`    | 外鍵，對應學生學號                  |
  | `CourseCode`   | 外鍵，對應課程代碼                  |
  | `Semester`     | 學期（如 112-1）                    |
  | `InstructorID` | 外鍵，授課講師（附屬屬性，不作為主鍵）|
  | `Grade`        | 成績                               |

## ER圖

![Lab05_03](https://github.com/Fukulyn/Lab-05/blob/main/Lab05_3/Lab05_03.png)







